---
params:
  subtitle: ""
  title: ""
  authors: ""
title: '`r params$title`'
subtitle: '`r params$subtitle`'
author: '`r params$authors`'
date: 'Last run at: `r getRunDateTime()`'
output:
  bookdown::html_document2:
    fig_caption: yes
    code_folding: hide
    number_sections: yes
    toc: yes
    toc_depth: 2
    toc_float: TRUE
    fig_width: 5
  bookdown::pdf_document2:
    fig_caption: yes
    number_sections: yes
  bookdown::word_document2:
    fig_caption: yes
    number_sections: yes
    toc: yes
    toc_depth: 2
    fig_width: 5
always_allow_html: yes
bibliography: '`r paste0(here::here(), "/bibliography.bib")`'
---

```{r knitrSetup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE) # by default turn off code echo
```


```{r codeSetup, include=FALSE}
# Set start time ----
startTime <- proc.time()
# Local parameters ----
b2Kb <- 1024 #http://whatsabyte.com/P1/byteconverter.htm
b2Mb <- 1048576
plotLoc <- paste0(repoParams$repoLoc, "/docs/plots/") # where to put the plots

# Packages used in the report ----
rmdLibs <- c("ggplot2", # plots
          "kableExtra" # fancy tables
          )
GREENGridEECA::loadLibraries(rmdLibs)
# Local functions ----
```

\newpage

# About

## Citation

```{r citation, child=repoParams$citation}
```

## Report circulation

 * Public â€“ this report is intended for publication following EECA approval.
 
## License {#license}

```{r ccby license, child=repoParams$licenseCCBY}
```
 
## History

```{r history, child=repoParams$history}
```
 * this [report's edit history](https://github.com/CfSOtago/GREENGridEECA/commits/master/reports/partA_dataProcessing)
 
## Support

```{r generic support, child=repoParams$support}
```
 
\newpage

# Introduction

Previous work conducted as part of this project has calculated the % contribution to peak power load (kW) and to overall annual consumption (kWh) for the ~ 40 New Zealand GREEN Grid household electricity demand study dwellings [@stephenson_smart_2017].

EECA have expressed an interest in understanding how these results and/or this sample of dwellings can be scaled up to provide estimates of the same values for the overall New Zealand residential dwelling stock/household population.

As is described in the [archived data package](https://cfsotago.github.io/GREENGridData/overviewReport_v1.0.html#4_study_recruitment), the New Zealand GREEN Grid household electricity demand study sample dwellings are unlikely to be representative of neither the two regions from which they were drawn nor New Zealand as a whole. In addition they form an extremely small sample. In combination, these two issues make it unlikely that upscaling the sample to represent the regions from which they were drawn and/or the national household population would produce very robust estimates unless we assume that the household population of interest will behave in more or less the same way. Whilst this assumption may be plausible in the case of, say, lighting, it is likely to be implausible in the case of space or hot water heating due to the spatial distribution of reticulated gas and the use of coal/wood as main energy sources. Neither of the latter are represented in the GREEN Grid dwelling sample _at all_.

Nevertheless it is still useful to review potential upscaling methods should we wish to make assumptions of this kind or for a future time when a larger and representative sample of New Zealand household's energy consumption data is available. It is possible, for example, that BRANZ's planned new Household Energy End-Use Project ([HEEP](https://www.branz.co.nz/heep)) version 2 could provide just such a data source.

The remainder of this report therefore introduces two potential upscaling methods both of which have been used with the GREEN Griod household electricity demand data in different ways and for different purposes. The first is a simple proportionate upscaling method used to analyse the potential impact of wide-scale Heat Pump uptake in New Zealand [@dortans_estimating_2019]. The second is a more complex re-weighting approach that uses iterative proportional fitting [simpson_combining_2005;@anderson_estimating_2012] to re-weight households on multiple dimensions to match known Census distributions [@anderson_small_2019].

# Simple Proportional Upscaling

> refer Carsten's MSc for method

# Complex re-weighting

> describe approach and build ipf-based model of total load for
 * Taranaki
 * Hawke's Bay
 * NZ
 using aggregated are unit Census data & half-hour total load data -> mean kW per half hour per season (using 2015) [@GREENGridTotalLoad]

# Summary

This report XXXX

This report described the results of this work and directed the reader to relevant R code where necessary.

All code used to create this report is available from:

 * https://github.com/CfSOtago/GREENGridEECA
 
The archived and most recent version of the report is available from:
 
 * https://cfsotago.github.io/GREENGridEECA/


```{r runToEnd}

```

# Data Annex

## Census data summary 
Descriptive statistics for census data:

```{r skimCensusData}
#skimr::skim(censusDT)
```

## GREEN Grid half-hourly total load summary 
Descriptive statistics for dwelling power data:

```{r skimPowerData}
#skimr::skim(powerDT)
```

## GREEN Grid household data summary 
Descriptive statistics for household data:

```{r skimHouseholdData}
#skimr::skim(householdDT)
```

# Runtime


```{r check runtime, include=FALSE}
t <- proc.time() - startTime
elapsed <- t[[3]]
```

Analysis completed in `r round(elapsed,2)` seconds ( `r round(elapsed/60,2)` minutes) using [knitr](https://cran.r-project.org/package=knitr) in [RStudio](http://www.rstudio.com) with `r R.version.string` running on `r R.version$platform`.

# R environment

## R packages used

 * base R [@baseR]
 * bookdown [@bookdown]
 * data.table [@data.table]
 * ggplot2 [@ggplot2]
 * kableExtra [@kableExtra]
 * knitr [@knitr]
 * lubridate [@lubridate]
 * rmarkdown [@rmarkdown]

## Session info

```{r sessionInfo, echo=FALSE}
sessionInfo()
```

# References
